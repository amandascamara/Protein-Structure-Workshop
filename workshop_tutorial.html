<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Protein Structure Workshop</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Protein Structure Workshop</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_pymol">PyMOL</a></li>
<li><a href="#_dssp">DSSP</a></li>
<li><a href="#_selecting_and_measuring_contacts">Selecting and measuring contacts</a></li>
<li><a href="#APBS">Surface distribution of electrostatic potential</a></li>
<li><a href="#_symmetry_mates">Symmetry mates</a></li>
<li><a href="#_rendering_a_figure">Rendering a figure</a></li>
<li><a href="#flex">Flexibility analyses</a></li>
<li><a href="#oligo">Analyses of oligomers</a></li>
<li><a href="#_making_mutations">Making mutations</a></li>
<li><a href="#_making_predictions_with_alphafold2">Making predictions with AlphaFold2</a>
<ul class="sectlevel2">
<li><a href="#_predicting_a_monomer">Predicting a monomer</a></li>
<li><a href="#_predicting_a_multimer">Predicting a multimer</a></li>
</ul>
</li>
<li><a href="#_analysing_the_output_of_alphafold2">Analysing the output of AlphaFold2</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_pymol">PyMOL</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="Pictures/PyMOL_logo.svg.png" alt="PyMOL logo.svg" width="100">
</div>
</div>
<div class="paragraph">
<p>PyMOL is a molecular visualization program written in Python, hence the 'Py' suffix.
It was released for the first time in 2000 as an open source and free software by DeLano Scientific LLC with a vision of open science.
Since 2010 it is commercialized by Schrödinger, Inc. and some of the source code are no longer released.
Pymol can be downloaded in Schrödinger&#8217;s <a href="https://pymol.org/2/">webpage</a>, including its source code.</p>
</div>
<div class="paragraph">
<p>Alternative programs are <a href="https://www.cgl.ucsf.edu/chimera/">Chimera</a>, <a href="http://www.openrasmol.org/">RasMOL</a>, <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a> (specially useful for molecular dynamics) and
<a href="https://www2.mrc-lmb.cam.ac.uk/personal/pemsley/coot/">Coot</a> (specially useful for building and validating models with crystallographic data).</p>
</div>
<div class="paragraph">
<p>PyMOL works both with graphical interface and command line.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture1.png" alt="Picture1">
</div>
</div>
<div class="paragraph">
<p>Those many options allow different ways of working with molecules to do the same things.
Throughout this tutorial we will show both ways, mouse actions and command lines, whenever possible.
Mouse actions will start with # and will be coloured in <span class="olive">olive</span>.
Command lines will follow &gt; and will be highlighted as Python codes.</p>
</div>
<div class="paragraph">
<p>We can open a structure file in different ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Open... -&gt; ... select downloaded 1t2d.pdb file
</span><span class="o">&gt;</span>
<span class="n">load</span> <span class="o">/</span><span class="n">path2file</span><span class="o">/</span><span class="mi">1</span><span class="n">t2d</span><span class="p">.</span><span class="n">pdb</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After uploaded, the structure will appear as a new object at the sidebar with the name of the file without the .pdb extension.
Note that if you try to load it again, a second state will be added to the same object, as indicated by the green numbers at the object tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture2.png" alt="Picture2" width="200">
</div>
</div>
<div class="paragraph">
<p>This is convenient when you have different models for the same structure, like proteins solved by Nuclear Magnetic Resonance, or different conformations of Molecular Dynamics, or different frames of a movie.
Let&#8217;s change the name of this object to avoid loading states onto it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 1t2d -&gt; rename object -&gt; Renaming 1t2d to 1t2d_pdb
</span><span class="o">&gt;</span>
<span class="n">set_name</span> <span class="mi">1</span><span class="n">t2d</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d_pdb</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another way to upload a structure is by online fetching.
This feature automatically searches for a .cif file in the online PDB with the given PDB code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Get PDB... -&gt; 1t2d
</span><span class="o">&gt;</span>
<span class="n">fetch</span> <span class="mi">1</span><span class="n">t2d</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you should have 2 objects displayed at your sidebar.
A click at the name of an object will disable or enable it.</p>
</div>
<div class="paragraph">
<p>The .pdb and .cif files have slightly different features in PyMOL, including how they&#8217;re loaded.
One difference is at the displayed sequence.
Enable the sequence bar with the S button.
Note that the first residue in the sequence of 1t2d object, which came from the .cif file, appears in grey.
This is a missing residue, which in the .pdb file in disregarded.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture3.png" alt="Picture3">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s work only with the 1t2d object and delete the other one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 1t2d_pdb -&gt; delete object
</span><span class="o">&gt;</span>
<span class="n">delete</span> <span class="mi">1</span><span class="n">t2d_pdb</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Roll the sequence bar and note that this 1t2d object has 5 chains: A is the protein, B is oxalate ion, C is NAD, D is glycerol and E are water molecules.
For the sake of easily analysing the protein structure, let&#8217;s remove the water molecules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 1t2d -&gt; remove waters
</span><span class="o">&gt;</span>
<span class="n">remove</span> <span class="n">solvent</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that chain E is gone.</p>
</div>
<div class="paragraph">
<p>Protein structures are automatically loaded in the cartoon representation mode, as listed in the Show tab.
In the cartoon mode, helices and strands are displayed as helices and arrows, respectively.
These two secondary structures (ss) can be easily differentiated by colour.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture4.png" alt="Picture4" width="500">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Color of 1t2d -&gt; by ss -&gt; choose first option
</span><span class="o">&gt;</span>
<span class="n">color</span> <span class="n">red</span><span class="p">,</span> <span class="n">ss</span> <span class="n">h</span>
<span class="n">color</span> <span class="n">yellow</span><span class="p">,</span> <span class="n">ss</span> <span class="n">s</span>
<span class="n">color</span> <span class="n">green</span><span class="p">,</span> <span class="n">ss</span> <span class="n">l</span><span class="o">+</span><span class="s">''</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dssp">DSSP</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The secondary structures assigned by PyMOL are rather simple and don&#8217;t distinguish between different types of helices, strands or loops.
It may also deviate a little from different versions of PyMOL.
The standard, and more rigorous, method to assign secondary structures is called <a href="https://swift.cmbi.umcn.nl/gv/dssp/">DSSP</a>, an acronym for Define Secondary Structure of Proteins.
Connected to slurm, we need to briefly load dssp program and a python library for plotting the results.
Then go to the workshop&#8217;s folder, create a folder for you and copy the scripts we are going to use to your folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">module load dssp
module load matplotlib
<span class="nb">cd</span> /filer/projekte/protein_structure_workshop/
<span class="nb">mkdir </span>amanda
<span class="nb">cd </span>amanda
<span class="nb">cp</span> ../scripts/<span class="k">*</span> .</code></pre>
</div>
</div>
<div class="paragraph">
<p>The dssp program outputs lots of information on hydrogen bonds and other geometrical features taken from the protein coordinates and used to assign the secondary structures
(more information <a href="https://swift.cmbi.umcn.nl/gv/dssp/">here</a>).
It also outputs information on solvent accessibility, for instance, but we are only interested on the assigned ss, so we will clean up the output file from dssp to use as in input to PyMOL.
Copy the downloaded 1t2d.pdb to your folder in slurm and run the following command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>
bash ssinfo.sh 1t2d.pdb <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first line in this script runs the dssp program and the rest clean the dssp output.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can now easily process this information into a coloured matrix to indicate ss into a plot and into PyMOL. We will do this with two python scripts.
They both take a list of files to process as in input.
This list of files is simply a list of the name of the .txt file we just created, followed by the name of the monomers or chains that they contain.
So first create a file named "dsspfileslist.txt".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>
vi dsspfileslist.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>In VI press the letter i to start writing and type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1t2d_dssp.txt monomerA</pre>
</div>
</div>
<div class="paragraph">
<p>Leave the insert mode by pressing esc and then save and close tipping :wq</p>
</div>
<div class="paragraph">
<p>This way of processing files, with a list of input files, is handy to compare different structures and monomers, where each line corresponds to one entry.
But for us, it just takes one file with one monomer.
Now we can create a colour map and an input file for PyMOL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>
python plot_dssp_colorbars.py dsspfileslist.txt
python dssp2pymol.py dsspfileslist.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Take a look at the python scripts you just used.
At the top of them there is a HEX colour code that you can change as you prefer.
You must have two output files now, monomerA_dssp.png and 1t2d_dssp.pml.
Copy them to your folder in your local Dektop to open them.
monomerA_dssp.png is a figure with a coloured matrix indicating the ss,</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture5.png" alt="Picture5" width="500">
</div>
</div>
<div class="paragraph">
<p>and 1t2d_dssp.pml is a file with commands to be read by PyMOL.
Let&#8217;s open it with PyMOL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Open... -&gt; 1t2d_dssp.pml
</span><span class="o">&gt;</span>
<span class="n">load</span> <span class="o">/</span><span class="n">path2file</span><span class="o">/</span><span class="mi">1</span><span class="n">t2d_dssp</span><span class="p">.</span><span class="n">pml</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s compare both ways of coloring in PyMOL.
Duplicate the 1t2d object and color it again as default by PyMOL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 1t2d -&gt; copy to object -&gt; new
# Color of obj01 -&gt; by SS -&gt; choose first option
</span><span class="o">&gt;</span>
<span class="n">copy</span> <span class="n">obj01</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span>
<span class="n">color</span> <span class="n">red</span><span class="p">,</span> <span class="n">obj01</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">h</span>
<span class="n">color</span> <span class="n">yellow</span><span class="p">,</span> <span class="n">obj01</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">s</span>
<span class="n">color</span> <span class="n">green</span><span class="p">,</span> <span class="n">obj01</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">l</span><span class="o">+</span><span class="s">''</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture6.png" alt="Picture6">
</div>
</div>
<div class="paragraph">
<p>Note how some strange helical turns are differently assigned by DSSP. When you are finished comparing the structures, delete obj01.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of obj01 -&gt; delete object
</span><span class="o">&gt;</span>
<span class="n">delete</span> <span class="n">obj01</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another common way of coloring the protein structure is by the residues count.
From blue to red in a rainbow scale.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Color of 1t2d -&gt; spectrum -&gt; rainbow
</span><span class="o">&gt;</span>
<span class="n">spectrum</span> <span class="n">count</span><span class="p">,</span> <span class="n">rainbow</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture6b.png" alt="Picture6b" width="500">
</div>
</div>
<div class="paragraph">
<p>From the python script, it is clear how any color can be selected using HEX codes with the command line. But any color can be created with mouse actions as well.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Settings -&gt; Colors... -&gt; Red 0,17 Green 0,66 Blue 0,74 Name NewBlue -&gt; Apply
</span><span class="o">&gt;</span>
<span class="n">set_color</span> <span class="n">NewBlue</span><span class="p">,</span> <span class="p">[</span><span class="mi">43</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">189</span><span class="p">]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_selecting_and_measuring_contacts">Selecting and measuring contacts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the view mode of the mouse, click the left button and move to rotate the protein structure.
Click the right button and move to zoom in and out.
Ctrl (or strg in German or command on Mac) + mouse left button to move the object on the image plane.
Other mouse functions together with keyboard shortcuts are possible, but they vary with mouse type.
Make sure the Selecting mode displays "Residues". Clicking on it again will change to other selection options.
Rotating the structure, see if you can find and select the first residue.
The first residue can also be selected at the sequence bar.
Now see if you can identify and select the alternating six beta strands and  five alpha helices that form the Rossmann fold.
Color the entire protein in white and highlight the Rossmann coloring its ss.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Color of 1t2d -&gt; grays -&gt; white
# in the sequence bar select residues 1-149
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to Rossmann
# Disable (Rossmann)
# Color of (Rossmann) -&gt; by ss -&gt; first option
</span><span class="o">&gt;</span>
<span class="n">color</span> <span class="n">white</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span>
<span class="n">select</span> <span class="n">Rossmann</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">1</span><span class="o">-</span><span class="mi">149</span>
<span class="n">color</span> <span class="n">red</span><span class="p">,</span> <span class="n">Rossmann</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">h</span>
<span class="n">color</span> <span class="n">yellow</span><span class="p">,</span> <span class="n">Rossmann</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">s</span>
<span class="n">color</span> <span class="n">green</span><span class="p">,</span> <span class="n">Rossmann</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">l</span><span class="o">+</span><span class="s">''</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureA.png" alt="PictureA" width="500">
</div>
</div>
<div class="paragraph">
<p>Note that NAD lies right above the Rossmann fold and let&#8217;s color it regarding its atoms.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># select the NAD molecule
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to NAD
# Disable (NAD)
# Color of (NAD) -&gt; by element -&gt; first option
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">NAD</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span> <span class="ow">and</span> <span class="n">resname</span> <span class="n">NAD</span>
<span class="n">color</span> <span class="n">atomic</span><span class="p">,</span> <span class="n">NAD</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">element</span> <span class="n">C</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureB.png" alt="PictureB" width="500">
</div>
</div>
<div class="paragraph">
<p>Now, find the residues that make polar contacts with NAD</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of (NAD) -&gt; find -&gt; polar contacts -&gt; to other atoms in object
</span><span class="o">&gt;</span>
<span class="n">dist</span> <span class="n">Hbonds</span><span class="p">,</span> <span class="p">(</span><span class="n">NAD</span><span class="p">),</span> <span class="mi">1</span><span class="n">t2d</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This created dashed lines to all hydrogen bonds found between NAD and the rest of the object.
But some lines point to nothing. Let&#8217;s find out what are at the other end of these lines.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of (NAD) -&gt; modify -&gt; around -&gt; residues within 4 A
# Action of (NAD) -&gt; rename selection -&gt; Renaming NAD to aroundNAD
# Show of (aroundNAD) -&gt; sticks
# Disable (aroundNAD)
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">aroundNAD</span><span class="p">,</span> <span class="n">byres</span> <span class="nb">all</span> <span class="n">within</span> <span class="mi">4</span> <span class="n">of</span> <span class="p">(</span><span class="n">NAD</span><span class="p">)</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="n">aroundNAD</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Try to identify exactly which residues make hydrogen bonds with NAD.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># select residues contacting NAD
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to resbond
# Disable (resbond)
# Hide of (aroundNAD) -&gt; sticks
# Show of (resbond) -&gt; sticks
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">resbond</span><span class="p">,</span> <span class="n">resid</span> <span class="mi">13</span><span class="o">+</span><span class="mi">14</span><span class="o">+</span><span class="mi">34</span><span class="o">+</span><span class="mi">66</span><span class="o">+</span><span class="mi">80</span><span class="o">+</span><span class="mi">124</span><span class="o">+</span><span class="mi">126</span><span class="o">+</span><span class="mi">149</span>
<span class="n">hide</span> <span class="n">sticks</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="n">resbond</span> <span class="ow">or</span> <span class="n">NAD</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureC.png" alt="PictureC" width="500">
</div>
</div>
<div class="paragraph">
<p>Note that all residues contacting the NAD molecule come from loops of the Rossmann fold, except those contacting the first helix of the folding.
Let&#8217;s measure the distance for this interaction between the phosphate of the NAD molecule and nitrogen of the first residues in the helix.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Wizard -&gt; Measurement -&gt; pick the first atom -&gt; pick the second atom -&gt; Done
</span><span class="o">&gt;</span>
<span class="n">dist</span> <span class="n">measurement1</span><span class="p">,</span> <span class="o">/</span><span class="mi">1</span><span class="n">t2d</span><span class="o">/</span><span class="n">A</span><span class="o">/</span><span class="n">A</span><span class="o">/</span><span class="n">ILE</span><span class="sb">`14/N, /1t2d/C/A/NAD`</span><span class="mi">323</span><span class="o">/</span><span class="n">O1N</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="APBS">Surface distribution of electrostatic potential</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Helices have an eletric dipole that can be particularly attractive.
The eletrostatic potential of a molecule can be calculated in PyMOL with the APBS plugin.
APBS stands for Adaptative Poisson-Boltzmann Solver.
It&#8217;s a program to numerically solve the rearrangement of charges of a molecule surrounded by a solvent with ions and dielectric properties.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PicturePB_wikipedia.jpg" alt="PicturePB wikipedia">
</div>
<div class="title">Figure 1. Redistribution of charges of the solid in response to the charges of the solvent [source: <a href="https://en.wikipedia.org/wiki/Poisson%E2%80%93Boltzmann_equation">wikipedia</a>].</div>
</div>
<div class="paragraph">
<p>Let&#8217;s calculate the distribution of the electrostatic potential at the surface of the first helix of the Rossmann fold.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># select residues 12-25
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to helix1
# Disable (helix1)
# Plugin -&gt; APBS Electrostatics -&gt; Selection polymer &amp; (helix1) -&gt; Yes
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">helix1</span><span class="p">,</span> <span class="n">resid</span> <span class="mi">12</span><span class="o">-</span><span class="mi">25</span>
<span class="kn">from</span> <span class="nn">pmg_tk.startup.apbs_gui.creating</span> <span class="kn">import</span> <span class="n">pdb2pqr_cli</span>
<span class="kn">from</span> <span class="nn">pmg_tk.startup.apbs_gui.electrostatics</span> <span class="kn">import</span> <span class="n">map_new_apbs</span>
<span class="n">pdb2pqr_cli</span><span class="p">(</span><span class="s">"prepared01"</span><span class="p">,</span> <span class="s">"(helix1)"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s">"--ff"</span><span class="p">,</span> <span class="s">"amber"</span><span class="p">])</span>
<span class="n">map_new_apbs</span><span class="p">(</span><span class="s">"apbs_map01"</span><span class="p">,</span> <span class="s">"prepared01"</span><span class="p">)</span>
<span class="n">ramp_new</span> <span class="n">apbs_ramp01</span><span class="p">,</span> <span class="n">apbs_map01</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">surface_ramp_above_mode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="nb">set</span> <span class="n">surface_color</span><span class="p">,</span> <span class="n">apbs_ramp01</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared01</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureD.png" alt="PictureD" width="500">
</div>
</div>
<div class="paragraph">
<p>Note how the beginning of the helix is more positive (or acidic), which attracts the negatively charged phosphates, and the end of the helix is more negative (or basic).</p>
</div>
<div class="paragraph">
<p>We should also analyse the electrostatic potential for this entire protein chain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Plugin -&gt; APBS Electrostatics -&gt; Selection polymer &amp; 1t2d -&gt; Yes -&gt; Yes
</span><span class="o">&gt;</span>
<span class="kn">from</span> <span class="nn">pmg_tk.startup.apbs_gui.creating</span> <span class="kn">import</span> <span class="n">pdb2pqr_cli</span>
<span class="kn">from</span> <span class="nn">pmg_tk.startup.apbs_gui.electrostatics</span> <span class="kn">import</span> <span class="n">map_new_apbs</span>
<span class="n">pdb2pqr_cli</span><span class="p">(</span><span class="s">"prepared02"</span><span class="p">,</span> <span class="s">"1t2d"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s">"--ff"</span><span class="p">,</span> <span class="s">"amber"</span><span class="p">])</span>
<span class="n">map_new_apbs</span><span class="p">(</span><span class="s">"apbs_map02"</span><span class="p">,</span> <span class="s">"prepared02"</span><span class="p">)</span>
<span class="n">ramp_new</span> <span class="n">apbs_ramp02</span><span class="p">,</span> <span class="n">apbs_map02</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">surface_ramp_above_mode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prepared02</span>
<span class="nb">set</span> <span class="n">surface_color</span><span class="p">,</span> <span class="n">apbs_ramp02</span><span class="p">,</span> <span class="n">prepared02</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared02</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureE.png" alt="PictureE" width="500">
</div>
</div>
<div class="paragraph">
<p>Note how NAD sits in a very acidic pocket.
And note that there is another very acidic region, possibly a region for binding something else.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_symmetry_mates">Symmetry mates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By the way, we forgot that this protein actually forms a biological tetramer!
We were looking only at the asymmetric unit.
Let&#8217;s generate its symmetry mates.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureF.png" alt="PictureF" width="500">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 1t2d -&gt; generate -&gt; symmetry mates -&gt; within 4 A
</span><span class="o">&gt;</span>
<span class="n">symexp</span> <span class="n">sym</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="n">t2d</span><span class="p">),</span> <span class="mi">4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This generates many new objects, each with one symmetric monomer of the original 1t2d, the asymmetric unit.
Try to find out the real monomers, which form a tetramer with 1t2d, and delete the other ones, which form the crystal lattice.</p>
</div>
<div class="paragraph">
<p><a href="https://www.ebi.ac.uk/pdbe/pisa/">PDBePISA</a> helps us to verify the biological assembly.
PISA stands for Protein Interfaces, Surfaces, and Assemblies.
It is an online tool provided by PDB Europe.
Given a pdb file, it provides information on protein interfaces, solvent accessibility, ligand binding sites and biological assemblies.</p>
</div>
<div class="paragraph">
<p>Last, run APBS for the three other monomers forming the tetramer, and check if the most charged surfaces are now satisfied with counter charges.
Note how the NAD pockets are still exposed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureG.png" alt="PictureG" width="500">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rendering_a_figure">Rendering a figure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Finally, PyMOL allows you to explore your artistic skills and render a clear and appealing figure for publication.
In this example, we focus on the interaction of the NAD molecule with the first helix of the Rossmann fold.
See if you can reproduce this image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture7.png" alt="Picture7">
</div>
</div>
<div class="paragraph">
<p>First, choose a position where the main characters are centralized.
Choose colors that highlight the main characters, and prefer to show only the necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="o">&gt;</span>
<span class="n">color</span> <span class="n">white</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">NAD</span>
<span class="n">color</span> <span class="n">salmon</span><span class="p">,</span> <span class="n">Rossmann</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">h</span>
<span class="n">color</span> <span class="n">paleyellow</span><span class="p">,</span> <span class="n">Rossmann</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">s</span>
<span class="n">color</span> <span class="n">palegreen</span><span class="p">,</span> <span class="n">Rossmann</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">l</span><span class="o">+</span><span class="s">''</span>
<span class="n">color</span> <span class="n">red</span><span class="p">,</span> <span class="n">obj01</span><span class="p">,</span> <span class="n">helix1</span>
<span class="n">hide</span> <span class="n">everything</span><span class="p">,</span> <span class="n">prepared02</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared02</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">12</span><span class="o">-</span><span class="mi">15</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">13</span><span class="o">-</span><span class="mi">14</span> <span class="ow">and</span> <span class="p">(</span><span class="n">name</span> <span class="n">c</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">ca</span><span class="p">)</span>
<span class="n">create</span> <span class="n">obj01</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">10</span><span class="o">-</span><span class="mi">25</span>
<span class="n">dist</span> <span class="n">H1NADbonds</span><span class="p">,</span> <span class="n">NAD</span><span class="p">,</span> <span class="n">helix1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span>
<span class="n">hide</span> <span class="n">labels</span><span class="p">,</span> <span class="n">H1NADbonds</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now make the background white and use transparency effects to highlight only main objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Display -&gt; Background -&gt; White
# Setting -&gt; Transparency -&gt; Surface -&gt; 50%
# Setting -&gt; Transparency -&gt; Cartoon -&gt; 20% <i class="conum" data-value="1"></i><b>(1)</b>
</span><span class="o">&gt;</span>
<span class="n">bg_color</span> <span class="n">white</span>
<span class="nb">set</span> <span class="n">transparency</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="nb">set</span> <span class="n">cartoon_transparency</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="nb">set</span> <span class="n">cartoon_transparency</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">obj01</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>With mouse commands, the transparency effect can only be applied to types of representation (surface, cartoon, sticks &#8230;&#8203;).
But with command line, the transparency can be applied to different objects.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, PyMOL has a <a href="https://pymolwiki.org/index.php/Ray">ray</a> option to render images with better quality.
There are four different ray modes (check the ray link), which we will use for different parts of the image.
Remember to hide the sequence bar, so all the partial images have all the same size when they are rendered.
Hide also light effects for a clearer image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Setting -&gt; Rendering -&gt; Shadows -&gt; None
# Display -&gt; Specular reflections (untick)
# Draw/Ray -&gt; Ray(Slow) -&gt; Save picture to file -&gt; img1.png
# Setting -&gt; Edit All... -&gt; ray_trace_mode set to 1
# Disable object prepared02
# Hide of 1t2d -&gt; cartoon
# Draw/Ray -&gt; Ray(Slow) -&gt; Save picture to file -&gt; img2.png
# Setting -&gt; Edit All... -&gt; ray_trace_mode set to 2
# Disable object obj01
# Draw/Ray -&gt; Ray(Slow) -&gt; Save picture to file -&gt; img3.png
</span><span class="o">&gt;</span>
<span class="nb">set</span> <span class="n">ray_shadows</span><span class="p">,</span> <span class="mi">0</span>
<span class="nb">set</span> <span class="n">specular</span><span class="p">,</span> <span class="n">off</span>
<span class="n">Ray</span>
<span class="n">png</span> <span class="n">img1</span><span class="p">.</span><span class="n">png</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>
<span class="nb">set</span> <span class="n">ray_trace_mode</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">disable</span> <span class="n">prepared02</span>
<span class="n">hide</span> <span class="n">cartoon</span><span class="p">,</span> <span class="mi">1</span><span class="n">t2d</span>
<span class="n">ray</span>
<span class="n">png</span> <span class="n">img2</span><span class="p">.</span><span class="n">png</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>
<span class="nb">set</span> <span class="n">ray_trace_mode</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">disable</span> <span class="n">obj01</span>
<span class="n">ray</span>
<span class="n">png</span> <span class="n">img3</span><span class="p">.</span><span class="n">png</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use your favourite program to edit the images together and add labels.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="flex">Flexibility analyses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Proteins are flexible molecules.
This aspect is essential for their function, and it cannot be overseen by experiments.
Sometimes, high flexibility hinders the acquisition of a structure, as it is the case for proteins with Intrinsically Disordered Regions (IDR).
Other times, the flexibility can be quantified and this data is stored in the coordinates files as well.
For protein structures solved by Nuclear Magnetic Resonance (NMR), a single pdb file contains several models (usually 20), corresponding to different conformations.</p>
</div>
<div class="paragraph">
<p>As we are going to work with another protein, let&#8217;s first save our current PyMOL session and start a new one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; save session -&gt; 1t2d.pse
# CLose PyMOL
</span><span class="o">&gt;</span>
<span class="n">save</span> <span class="mi">1</span><span class="n">t2d</span><span class="p">.</span><span class="n">pse</span>
<span class="n">quit</span><span class="p">()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And now, let&#8217;s check the structure of At3g01050, a ubiquitin-fold protein from Arabidopsis thaliana solved by solution NMR.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Open PyMOL
# File -&gt; Get PDB... -&gt; 1se9
</span><span class="o">&gt;</span>
<span class="n">pymol</span>
<span class="n">fetch</span> <span class="mi">1</span><span class="n">se9</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>1se9 object was loaded with 20 states, corresponding to 20 models.
They are usually observed superposed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 1se9 -&gt; state -&gt; all state
</span><span class="o">&gt;</span>
<span class="nb">set</span> <span class="n">all_states</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="mi">1</span><span class="n">se9</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Color by secondary structure again and note how loops are more flexible than helices and sheets.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/PictureH.png" alt="PictureH" width="500">
</div>
</div>
<div class="paragraph">
<p>In another way, structures from x-ray diffraction carry Atomic Displacement Parameters (ADPs), proportional to the amount of smearing of the electron density.
The emperature factor, or B factor, or Debye-Waller factor, is a single parameter per atom.
It is the average displacement around each atom&#8217;s position.
Higher B factors indicate higher flexibility.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s check a protein with a TIM barrel motif.
Delete everything and fetch the code 4pc8.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of all -&gt; delete everything
# File -&gt; Get PDB... -&gt; 4pc8
</span><span class="o">&gt;</span>
<span class="n">delete</span> <span class="nb">all</span>
<span class="n">fetch</span> <span class="mi">4</span><span class="n">pc8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are three different ways of visualizing temperature factors with PyMOL.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture8.png" alt="Picture8">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Color of 4pc8 -&gt; spectrum -&gt; b-factors <i class="conum" data-value="1"></i><b>(1)</b>
# Action of 4pc8 -&gt; preset -&gt; b factor putty <i class="conum" data-value="2"></i><b>(2)</b>
</span><span class="o">&gt;</span>
<span class="n">spectrum</span> <span class="n">b</span><span class="p">,</span> <span class="n">rainbow</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span> <i class="conum" data-value="3"></i><b>(3)</b>
<span class="n">cartoon</span> <span class="n">putty</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span>
<span class="n">hide</span> <span class="n">cartoon</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span>
<span class="n">show</span> <span class="n">spheres</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span>
<span class="n">remove</span> <span class="n">solvent</span>
<span class="n">alter</span> <span class="nb">all</span><span class="p">,</span> <span class="n">vdw</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="mi">50</span> <i class="conum" data-value="4"></i><b>(4)</b>
<span class="n">rebuild</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first is by changing the color by the B factor, and this can be done with any type of representation (cartoon, sticks, surface,&#8230;&#8203;).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The second is by showing a tube-like structure with radius proportional to the B factors of the alpha carbons.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>With command line, the rainbow keyword represents a color scale.
Other color scales can be found <a href="https://pymolwiki.org/index.php/Spectrum">here</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The third method is by showing spheres, whose radius are proportional to the B factors.
Unfortunately, it can only be applied with command lines.
Note that the divisor can be changed for better visualization.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a structure has enough resolution, anisotropic ADPs may be given, consisting of 6 parameters per atom.
In this case, the atomic displacement can be showed as
<a href="https://pymolwiki.org/index.php/Ellipsoids">ellipsoids</a> instead, which indicate a directionality in the atomic movement.</p>
</div>
<div class="paragraph">
<p>Temperature factors can also be plot in a 2D graphic for easier comparison with other structures.
For this we will use slurm and a python script with a special library for handling pdb files,
<a href="https://biopython.org/wiki/The_Biopython_Structural_Bioinformatics_FAQ">biopython</a>.
Again, this python script takes a list of files as input, and the name of the chain you want to analyse.
So create a text file called "pdbfileslist.txt" with just one line and two columns, one for the name of the file and the other for the name of the chain to be considered, as below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">4pc8.pdb A</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the python script plot_bfactor.py as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>
<span class="nb">cp</span> ../backup_pdbs/4pc8.pdb <span class="nb">.</span>
python plot_bfactor.py pdbfileslist.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output shows the B factor per residue number.
Check that the highest values correspond to loops of the TIM barrel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture9.png" alt="Picture9" width="500">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="oligo">Analyses of oligomers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Protein oligomers are more common in nature than monomers <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6925524/">(Gwyther et al. 2019)</a>.
Here we will look at a heptamer, check its interfaces with PyMOL and create a heat map for its contacts.</p>
</div>
<div class="paragraph">
<p>Before starting new, make sure to save your current session and start a new one.
Fetch the pdb 1i8f, remove waters and color the object by chain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Get PDB... -&gt; 1i8f
# Action of 1i8f -&gt; remove waters
# Color of 1i8f -&gt; by chain
</span><span class="o">&gt;</span>
<span class="n">fetch</span> <span class="mi">1</span><span class="n">i8f</span>
<span class="n">remove</span> <span class="n">solvent</span>
<span class="n">util</span><span class="p">.</span><span class="n">cbc</span> <span class="mi">1</span><span class="n">i8f</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Find polar contacts between chain A and B and show the participating residues in sticks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Mouse selection mode Chain -&gt; select chains A and B
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to AandB
# Action of (AandB) -&gt; find -&gt; polar contacts -&gt; between chains
# Show of (AandB) -&gt; sticks
# Mouse selection mode Residues -&gt; select residues connected by the dashes
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to polar
# Hide of (AandB) -&gt; sticks
# Show of (polar) -&gt; sticks
# Color of (polar) -&gt; by element -&gt; first option
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">polar</span><span class="p">,</span> <span class="n">byres</span> <span class="p">((</span><span class="n">chain</span> <span class="n">B</span> <span class="ow">and</span> <span class="p">(</span><span class="n">donors</span> <span class="ow">or</span> <span class="n">acceptors</span><span class="p">))</span> <span class="n">within</span> <span class="mf">3.5</span> <span class="n">of</span> <span class="p">(</span><span class="n">chain</span> <span class="n">A</span> <span class="ow">and</span> <span class="p">(</span><span class="n">donors</span> <span class="ow">or</span> <span class="n">acceptors</span><span class="p">)))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">chain</span> <span class="n">A</span> <span class="ow">and</span> <span class="p">(</span><span class="n">donors</span> <span class="ow">or</span> <span class="n">acceptors</span><span class="p">))</span> <span class="n">within</span> <span class="mf">3.5</span> <span class="n">of</span> <span class="p">(</span><span class="n">chain</span> <span class="n">B</span> <span class="ow">and</span> <span class="p">(</span><span class="n">donors</span> <span class="ow">or</span> <span class="n">acceptors</span><span class="p">)))</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="n">polar</span>
<span class="n">dist</span> <span class="n">polarbonds</span><span class="p">,(</span><span class="n">chain</span> <span class="n">A</span> <span class="n">within</span> <span class="mf">3.5</span> <span class="n">of</span> <span class="n">chain</span> <span class="n">B</span><span class="p">),(</span><span class="n">chain</span> <span class="n">B</span> <span class="n">within</span> <span class="mf">3.5</span> <span class="n">of</span> <span class="n">chain</span> <span class="n">A</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span>
<span class="n">color</span> <span class="n">atomic</span><span class="p">,</span> <span class="n">polar</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">element</span> <span class="n">C</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that not all residues in the interface between chains make hydrogen bonds.
At least, hydrogen bonds as defined by <a href="https://pymolwiki.org/index.php/Displaying_Biochemical_Properties">PyMOL</a>
, which takes geometrical features into consideration and doesn&#8217;t really finds lone pairs of electrons and protons.
The find button, or the <a href="https://pymolwiki.org/index.php/Distance">distance command</a>,
identifies interactions based on geometry and standard atomic charges depending on the chosen mode, like polar or any contacts.
Among the residues that are close to each other at the interface, we can select hydrophobic ones, besides the ones making polar contacts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Mouse selection mode Chain -&gt; select chains B and C
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to BandC
# Action of (BandC) -&gt; find -&gt; any contacts -&gt; between chains within 3.5 Å
# Show of (BandC) -&gt; sticks
# Mouse selection mode Residues -&gt; select hydrophobic residues connected by the dashes
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to hydrophobic
# Hide of (BandC) -&gt; sticks
# Action of BandC_interchain_any -&gt; delete
# Show of (hydrophobic) -&gt; sticks
# Color of (hyrdophobic) -&gt; oranges -&gt; orange
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">hydrophobic</span><span class="p">,</span> <span class="p">(</span><span class="n">resn</span> <span class="n">ala</span><span class="o">+</span><span class="n">gly</span><span class="o">+</span><span class="n">val</span><span class="o">+</span><span class="n">ile</span><span class="o">+</span><span class="n">leu</span><span class="o">+</span><span class="n">phe</span><span class="o">+</span><span class="n">met</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">byres</span> <span class="n">chain</span> <span class="n">B</span> <span class="n">within</span> <span class="mf">3.5</span> <span class="n">of</span> <span class="n">chain</span> <span class="n">C</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">byres</span> <span class="n">chain</span> <span class="n">C</span> <span class="n">within</span> <span class="mf">3.5</span> <span class="n">of</span> <span class="n">chain</span> <span class="n">B</span><span class="p">))</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="n">hydrophobic</span>
<span class="n">color</span> <span class="n">orange</span><span class="p">,</span> <span class="n">hydrophobic</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture10.png" alt="Picture10">
</div>
</div>
<div class="paragraph">
<p>A map of contacts can be very helpful to identify interchain contacts as well.
We can generate it using the biopython library again.
Similar to the analysis of B factors, first create a file "pdbfileslist_cm.txt", which contains a list of files and names of the chains you want to consider.
In this case there are two chains per entry, for the x axis and for the y axis.
Let&#8217;s make two plots. One of interchain contacts and another of intrachain contacts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">1i8f.pdb A A
1i8f.pdb A B</code></pre>
</div>
</div>
<div class="paragraph">
<p>And now run the python script.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>
<span class="nb">cp</span> ../backup_pdbs/1i8f.pdb <span class="nb">.</span>
python plot_cm.py pdbfileslist_cm.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>This plots a heatmap of distances between alpha carbons of each residue of the chosen chains.
In the interchain contact map, close parallel lines (at the N terminal) indicate an alpha helix structure, antiparallel indicate neighbour beta strands
and parallel lines far from the main diagonal indicate a second beta strand in the beta sheet.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture11.png" alt="Picture11">
</div>
</div>
<div class="paragraph">
<p>Besides contacting residues, we can look at the shape of the interface, back with PyMOL.
The surface is calculated in <a href="https://pymolwiki.org/index.php/Surface">PyMOL</a>
as the area accessible to a rolling a ball, like a solvent molecule would do.
The radius of this ball is previously defined and usually relates to the radius of a water molecule, typically 1.4 Å.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture_RollingBall_wikipedia.png" alt="Picture RollingBall wikipedia" width="200">
</div>
<div class="title">Figure 2. Illustration of the calculation of solvent accessible surfaces [source: <a href="https://en.wikipedia.org/wiki/Accessible_surface_area">wikipedia</a>].</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Mouse selection mode Chain -&gt; select chain D
# Action of (sele) -&gt; copy to object -&gt; new
# Mouse selection mode Chain -&gt; select chain E
# Action of (sele) -&gt; copy to object -&gt; new
# Show of obj01 -&gt; surface
# Show of obj02 -&gt; surface
</span><span class="o">&gt;</span>
<span class="n">create</span> <span class="n">obj01</span><span class="p">,</span> <span class="mi">1</span><span class="n">i8f</span> <span class="ow">and</span> <span class="n">chain</span> <span class="n">D</span>
<span class="n">create</span> <span class="n">obj02</span><span class="p">,</span> <span class="mi">1</span><span class="n">i8f</span> <span class="ow">and</span> <span class="n">chain</span> <span class="n">E</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">obj01</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">obj02</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Rolling the wheel of the mouse, or using the <a href="https://pymolwiki.org/index.php/Clip">clip</a> command, you can observe the objects in slices.
Note how knobs and holes on the surfaces complement themselves.</p>
</div>
<div class="paragraph">
<p>Check also how the distribution of electrostatic potential at the surface of neighbouring chains complement themselves using the method we learnt (<a href="#APBS">Surface distribution of electrostatic potential</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># select chain F
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to chainF
# Plugin -&gt; APBS Electrostatics -&gt; Selection polymer &amp; (chainF) -&gt; Yes
# select chain G
# Action of (sele) -&gt; rename selection -&gt; Renaming sele to chainF
# Plugin -&gt; APBS Electrostatics -&gt; Selection polymer &amp; (chainG) -&gt; Yes
</span><span class="o">&gt;</span>
<span class="kn">from</span> <span class="nn">pmg_tk.startup.apbs_gui.creating</span> <span class="kn">import</span> <span class="n">pdb2pqr_cli</span>
<span class="kn">from</span> <span class="nn">pmg_tk.startup.apbs_gui.electrostatics</span> <span class="kn">import</span> <span class="n">map_new_apbs</span>
<span class="n">select</span> <span class="n">chainF</span><span class="p">,</span> <span class="n">chain</span> <span class="n">F</span>
<span class="n">pdb2pqr_cli</span><span class="p">(</span><span class="s">"prepared01"</span><span class="p">,</span> <span class="s">"(chainF)"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s">"--ff"</span><span class="p">,</span> <span class="s">"amber"</span><span class="p">])</span>
<span class="n">map_new_apbs</span><span class="p">(</span><span class="s">"apbs_map01"</span><span class="p">,</span> <span class="s">"prepared01"</span><span class="p">)</span>
<span class="n">ramp_new</span> <span class="n">apbs_ramp01</span><span class="p">,</span> <span class="n">apbs_map01</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">surface_ramp_above_mode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="nb">set</span> <span class="n">surface_color</span><span class="p">,</span> <span class="n">apbs_ramp01</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared01</span>
<span class="n">select</span> <span class="n">chainG</span><span class="p">,</span> <span class="n">chain</span> <span class="n">G</span>
<span class="n">pdb2pqr_cli</span><span class="p">(</span><span class="s">"prepared02"</span><span class="p">,</span> <span class="s">"(chainG)"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s">"--ff"</span><span class="p">,</span> <span class="s">"amber"</span><span class="p">])</span>
<span class="n">map_new_apbs</span><span class="p">(</span><span class="s">"apbs_map02"</span><span class="p">,</span> <span class="s">"prepared02"</span><span class="p">)</span>
<span class="n">ramp_new</span> <span class="n">apbs_ramp02</span><span class="p">,</span> <span class="n">apbs_map02</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">surface_ramp_above_mode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prepared02</span>
<span class="nb">set</span> <span class="n">surface_color</span><span class="p">,</span> <span class="n">apbs_ramp02</span><span class="p">,</span> <span class="n">prepared02</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared02</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture12.png" alt="Picture12">
</div>
</div>
<div class="paragraph">
<p>Last, generate the surface of electrostatic potential distribution for the entire heptamer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Plugin -&gt; APBS Electrostatics -&gt; Selection polymer &amp; (1i8f) -&gt; Yes
</span><span class="o">&gt;</span>
<span class="n">pdb2pqr_cli</span><span class="p">(</span><span class="s">"prepared03"</span><span class="p">,</span> <span class="s">"(1i8f)"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s">"--ff"</span><span class="p">,</span> <span class="s">"amber"</span><span class="p">])</span>
<span class="n">map_new_apbs</span><span class="p">(</span><span class="s">"apbs_map03"</span><span class="p">,</span> <span class="s">"prepared03"</span><span class="p">)</span>
<span class="n">ramp_new</span> <span class="n">apbs_ramp02</span><span class="p">,</span> <span class="n">apbs_map03</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">surface_ramp_above_mode</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prepared03</span>
<span class="nb">set</span> <span class="n">surface_color</span><span class="p">,</span> <span class="n">apbs_ramp03</span><span class="p">,</span> <span class="n">prepared03</span>
<span class="n">show</span> <span class="n">surface</span><span class="p">,</span> <span class="n">prepared03</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Compare the electrostatic surface of the entire heptamer with the surface of only one of its chains.
Note how the charge distribution differs greatly at both sides of this doughnut-shaped protein.
It makes this protein a strong dipole.
Can you imagine what is its <a href="https://www.pnas.org/doi/full/10.1073/pnas.091102298">function</a>?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture13.png" alt="Picture13">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_making_mutations">Making mutations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With PyMOL we can easily mutate a residue or (re)build a fragment.
It even fixes bad contacts!
These tools can be used to make homology models.
Meaning build a protein model by comparison with a homologous protein that already has an available structure.
In this exercise we will make single residue mutations in two of the proteins we analysed, 4pc8 and 1i8f.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with 4pc8, the TIM barrel example.
The name TIM barrel comes from the first enzyme identified with this motif, the triose-phosphate isomerase (TIM).
The TIM barrel is evolutionary old and ubiquitous in nature, but the proteins possessing this motif are highly diverse in sequence
<a href="https://www.sciencedirect.com/science/article/pii/S0022283602006496?casa_token=gRlbbpLcRT8AAAAA:OTqQvYxPEpQERNMg0N0cQqDbzNJ_pHKWYd-eWYyy7aQ3lwMSqsgDmmT5aNrMXZ9kxk4t_OKL24c">[Nagano et al. 2002</a>].
The great majority of them are enzymes and the catalytic site is always regulated by the loops of the top of the barrel, whereas the loops at the bottom help stabilising the structure.</p>
</div>
<div class="paragraph">
<p>4pc8 is the structure of a monomeric TIM barrel resulting of an
<a href="https://onlinelibrary.wiley.com/iucr/doi/10.1107/S2053230X16007548">evolutionary study</a> on mutations of TIM.
It is accompanied by another solved structure, 4pcf, which has 4 mutations compared to 4pc8.
One of these mutations, Q65L, at the top loops of the barrel, affects flexibility and enzymatic activity.
So let&#8217;s compare the B factors of both structures.
Check that you have 4pcf.cif in your folder and add an entry to our "pdbfileslist.txt" file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">4pc8.pdb A
4pcf.cif A</code></pre>
</div>
</div>
<div class="paragraph">
<p>And run the plot_bfactor.py script again.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>
python plot_bfactor.py pdbfileslist.txt</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture14.png" alt="Picture14" width="500">
</div>
</div>
<div class="paragraph">
<p>Note how 4pcf has a globally lower B factor than 4pc8.
4pcf has also a lower resolution than 4pc8, so it is hard to conclude from that alone that residues in 4pcf are really less flexible.
But we can still make some comparisons.
Look how residue 65 has a much higher B factor in 4pcf than in 4pc8, relative to the rest of the structure.
On the other hand, the region around residue 15 has a much higher B factor in 4pc8 than in 4pcf, relative to the rest of the structure.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s compare them with PyMOL</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Get PDB... -&gt; 4pc8
# File -&gt; Get PDB... -&gt; 4pcf
# Action of all -&gt; remove waters
</span><span class="o">&gt;</span>
<span class="n">fetch</span> <span class="mi">4</span><span class="n">pc8</span>
<span class="n">fetch</span> <span class="mi">4</span><span class="n">pcf</span>
<span class="n">remove</span> <span class="n">solvent</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Contrary to 4pc8, 4pcf has three monomers in its asymmetric unit, but its biological unit is still a monomer.
So let&#8217;s take one of the monomers of 4pcf and forget about the others to facilitate our lives.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Select chain A of 4pcf
# Action of (sele) -&gt; copy to object -&gt; new
# Action of obj01 -&gt; rename object -&gt; to 4pcf_A
# Disable 4pcf
</span><span class="o">&gt;</span>
<span class="n">create</span> <span class="mi">4</span><span class="n">pcf_A</span><span class="p">,</span> <span class="mi">4</span><span class="n">pcf</span> <span class="ow">and</span> <span class="n">chain</span> <span class="n">A</span>
<span class="n">disable</span> <span class="mi">4</span><span class="n">pcf</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we superpose both structures.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Action of 4pcf_A -&gt; align -&gt; to molecule -&gt; 4pc8
# Action of 4pc8 -&gt; center
</span><span class="o">&gt;</span>
<span class="n">align</span> <span class="mi">4</span><span class="n">pcf_A</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span>
<span class="n">center</span> <span class="mi">4</span><span class="n">pc8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This superposes both structures to a least Root Mean Squared Deviation (RMSD) of all alpha carbons that could be aligned.
If you use the mouse commands, it also outputs a sequence alignment, indicating which group of residues are being superposed.
As it is a global superposition, sometimes very flexible regions affect the superposition negatively.
You can also choose to superpose only parts of the protein.
Let&#8217;s superpose only the beta barrel.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Select the residues of 4pc8 in the beta barrel
# Action of (sele) -&gt; rename selection -&gt; to bsheet_4pc8
# Select the residues of 4pcf in the beta barrel
# Action of (sele) -&gt; rename selection -&gt; to bsheet_4pcf
# Action of bsheet_4pcf -&gt; align -&gt; to selection -&gt; bsheet_4pc8
</span><span class="o">&gt;</span>
<span class="n">select</span> <span class="n">bsheet_4pc8</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">s</span>
<span class="n">select</span> <span class="n">bsheet_4pcf</span><span class="p">,</span> <span class="mi">4</span><span class="n">pcf_A</span> <span class="ow">and</span> <span class="n">ss</span> <span class="n">s</span>
<span class="n">align</span> <span class="n">bsheet_4pcf</span><span class="p">,</span> <span class="n">bsheet_4pc8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ok! Let&#8217;s check the mentioned  mutation and how it changes polar contacts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Select residue 65 of 4pcf_A
# Action of (sele) -&gt; rename selection to Q65
# Show of (Q65) -&gt; sticks
# Action of (Q65) -&gt; find -&gt; polar contacts -&gt; to other atoms in object
# Select residue 65 of 4pc8
# Action of (sele) -&gt; rename selection to L65
# Show of (L65) -&gt; sticks
# Action of (L65) -&gt; find -&gt; polar contacts -&gt; to other atoms in object
</span><span class="o">&gt;</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="mi">4</span><span class="n">pcf_A</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">65</span>
<span class="n">dist</span> <span class="n">Q65</span><span class="p">,</span> <span class="mi">4</span><span class="n">pcf_A</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">4</span><span class="n">pcf_A</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span>
<span class="n">show</span> <span class="n">sticks</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">65</span>
<span class="n">dist</span> <span class="n">Hbonds_4pc8</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span> <span class="ow">and</span> <span class="n">resid</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">4</span><span class="n">pc8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note how the Q65L mutation affects a neighbour loop, which is close to the active site.
Leucine65 in 4pc8 can only make a hydrogen bond through its main atoms with the next beta strand.
On the other hand, Glutamine65 in 4pcf makes 2 hydrogen bonds with the first beta strand of the barrel, making it a tighter packing.</p>
</div>
<div class="paragraph">
<p>Although 4pcf and 4pc8 have 4 single mutations, this one is regarded as key by the authors of the study.
Let&#8217;s mutate the Glutamine65 of 4pcf to a Leucine!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># Wizard -&gt; Mutagenesis -&gt; Pick Glutamine65 of 4pcf_A
# No Mutation -&gt; Mutate to LEU -&gt; change states to find a rotamer without clashes -&gt; Apply -&gt; Done
# Enable 4pc8
# Wizard -&gt; Sculpting -&gt; Pick one atom of the new Leucine65 -&gt; and drag it around with ctrl (strg in German or command on Mac) + mouse left button
# File -&gt; Export Molecule -&gt; 4pcf_A
</span><span class="o">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Does your mutated 4pcf look more similar to 4pc8?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture15.png" alt="Picture15">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s mutate the second protein now, the heptamer.
Don&#8217;t forget to save your current session before starting a new one.
We have seen how important it is for beta strands to complement each other.
Let&#8217;s try to disrupt a beta strand from the interface between monomers, and see if the oligomerization is affected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="c1"># File -&gt; Open... -&gt; 1i8f.pse
# Action of 1i8f -&gt; copy to object -&gt; new
</span><span class="o">&gt;</span>
<span class="n">load</span> <span class="o">/</span><span class="n">path2file</span><span class="o">/</span><span class="mi">1</span><span class="n">i8f</span><span class="p">.</span><span class="n">pse</span>
<span class="n">create</span> <span class="n">obj03</span><span class="p">,</span> <span class="mi">1</span><span class="n">i8f</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Focus on the interchain polar bonds and the interchain contact map that we&#8217;ve seen before (<a href="#oligo">Analyses of oligomers</a>).
Try to choose a key residue from last beta strand of chain A, which could disrupt its own beta strand and oligomerization interface.</p>
</div>
<div class="paragraph">
<p>You possibly foundlo Isoleucine76.
Let&#8217;s mutate it to a Proline.
Proline is the only residue whose lateral chain closes back with its main chain.
This forces the peptide bond to form different angles and also takes the last free proton from the amino group, preventing hydrogen bonds with other atoms.
Try to go over the mutagenesis steps again and make the mutation I76P.
Pay attention to changes in the beta strand after sculpting and find for polar contacts again.
Do you see any difference?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture16.png" alt="Picture16">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_making_predictions_with_alphafold2">Making predictions with AlphaFold2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Running AlphaFold is much easier than understanding it.
It takes only one fasta file and one command line.
Besides a few parameters that can be changed, AlphaFold runs have only two main options - for monomers or multimers.
We will try both with the same mutants we created before.</p>
</div>
<div class="sect2">
<h3 id="_predicting_a_monomer">Predicting a monomer</h3>
<div class="paragraph">
<p>First the TIM barrel example, a monomer.
In the PDB webpage check the fasta sequence of 4pcf and create a fasta file with the mutation, 4pcf_Q65L.fasta.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>4pcf_Q65L
MSKPQPIAAANWKSGSPDSLSGLIDLFNSTSINHDVQCVVASTFVHLAMT
KERLSHPKFVIAALNAGNTDALASLKDFGVNWIVLGHFERRWYYGETNEI
VADKVAAAVASGFMVIACIGETLQERESGRTAVVVLTQIAAIAKKLKKAD
WAKVVIAYEPVWAIGTGKVVTPQQAQEAHALIRSWVSSKIGADVAGELRI
LYGGSVNGKNARTLYQQRDVNGFLAGLKPEFVDIIKATQ</code></pre>
</div>
</div>
<div class="paragraph">
<p>The AlphaFold command needs many input parameters, but most of them concern the databases, which are installed in IPK&#8217;s server, and only three of them need actual changing.
So, because it&#8217;s a very long but standard command we will use a standard bash file already in the folder of the workshop, monomer.sbatch,
 which after the corresponding changes we can name "4pcf_Q65L.sbatch".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c">#!/bin/bash </span><i class="conum" data-value="1"></i><b>(1)</b>

<span class="c">#SBATCH --auks=yes </span><i class="conum" data-value="2"></i><b>(2)</b>
<span class="c">#SBATCH --partition=gpu</span>
<span class="c">#SBATCH --gpus=1 </span><i class="conum" data-value="3"></i><b>(3)</b>
<span class="c">#SBATCH --cpus-per-task=16 </span><i class="conum" data-value="3"></i><b>(3)</b>
<span class="c">#SBATCH --mem=100000 </span><i class="conum" data-value="4"></i><b>(4)</b>
<span class="c">#SBATCH --output=monomer.out </span><i class="conum" data-value="5"></i><b>(5)</b>

<span class="nv">dbdir</span><span class="o">=</span>/filer-dg/agruppen/DG/camara/AlphaFold_databases <i class="conum" data-value="6"></i><b>(6)</b>

<span class="nb">.</span> /etc/profile.d/modules.sh <i class="conum" data-value="7"></i><b>(7)</b>
module load alphafold
module load cuda-toolkit

<span class="nb">export </span><span class="nv">OPENMM_CUDA_COMPILER</span><span class="o">=</span>/opt/Bio/cuda-toolkit/11.6/bin/nvcc <i class="conum" data-value="8"></i><b>(8)</b>
<span class="nb">export </span><span class="nv">SINGULARITY_BIND</span><span class="o">=</span><span class="s2">"/filer,/filer-dg/agruppen/DG/camara/AlphaFold_databases/"</span>

singularity run <span class="nt">-B</span> /home/camara/AlphaFold/alphafold/modified_run_alphafold.py:/app/alphafold/run_alphafold.py /opt/Bio/alphafold/2.30.0/bin/alphafold <span class="se">\ </span><i class="conum" data-value="9"></i><b>(9)</b>
  <span class="nt">--max_template_date</span><span class="o">=</span>2100-01-01 <span class="se">\</span>
  <span class="nt">--uniref90_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/uniref90/uniref90.fasta <span class="se">\</span>
  <span class="nt">--mgnify_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/mgnify/mgy_clusters_2022_05.fa <span class="se">\</span>
  <span class="nt">--template_mmcif_dir</span><span class="o">=</span><span class="nv">$dbdir</span>/pdb_mmcif/mmcif_files <span class="se">\</span>
  <span class="nt">--obsolete_pdbs_path</span><span class="o">=</span><span class="nv">$dbdir</span>/pdb_mmcif/obsolete.dat <span class="se">\</span>
  <span class="nt">--use_gpu_relax</span><span class="o">=</span><span class="nb">true</span> <span class="se">\ </span><i class="conum" data-value="10"></i><b>(10)</b>
  <span class="nt">--bfd_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/bfd/bfd_metaclust_clu_complete_id30_c90_final_seq.sorted_opt <span class="se">\</span>
  <span class="nt">--uniref30_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/uniref30/UniRef30_2021_03 <span class="se">\</span>
  <span class="nt">--pdb70_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/pdb70/pdb70 <span class="se">\</span>
  <span class="nt">--fasta_paths</span><span class="o">=</span>/home/camara/AlphaFold/workshop/monomer.fasta <span class="se">\ </span><i class="conum" data-value="11"></i><b>(11)</b>
  <span class="nt">--model_preset</span><span class="o">=</span>monomer_ptm <span class="se">\ </span><i class="conum" data-value="12"></i><b>(12)</b>
  <span class="nt">--data_dir</span><span class="o">=</span><span class="nv">$dbdir</span> <span class="se">\</span>
  <span class="nt">--output_dir</span><span class="o">=</span>/filer-dg/agruppen/DG/camara/AlphaFold_models/workshop/ <i class="conum" data-value="13"></i><b>(13)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Usual first line of bash files indicating the operating system to use bash to interpret it.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Some sbatch commans to send this as a job to slurm.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Amount of gpus and cpus to be used. Don&#8217;t be greedy. This is enough.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Amount of memory required. Change here if your protein is too big and you&#8217;re running into memory issues.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Change the name of the output file (4pcf_Q65L.out). It stores some information on the alphafold run.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Indicating where the databases are installed.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Loading some required modules,</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>And exporting some paths.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>The actual call for AlphaFold, and lots of paths for the databases below.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>To relax the model or not. Keep it like this.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Change the name and path of the fasta file (/filer/projekte/protein_structure_workshop/amanda/4pcf_Q65L.fasta).</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Indicating its predicting a monomer.</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>Change the path for the output, to your folder inside the workshop&#8217;s folder (/filer/projekte/protein_structure_workshop/amanda).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we&#8217;re ready to send the job to slurm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">sbatch 4pcf_Q65L.sbatch</code></pre>
</div>
</div>
<div class="paragraph">
<p>Done! Now we wait.
Meanwhile, check if your job is already running or waiting in the queue</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">squeue <span class="nt">--me</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also check if the output is being generated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="nb">ls</span> /filer/projekte/protein_structure_workshop/amanda/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or go ahead and run control predictions of the original fasta sequences of 4pcf and 4pc8.</p>
</div>
</div>
<div class="sect2">
<h3 id="_predicting_a_multimer">Predicting a multimer</h3>
<div class="paragraph">
<p>Our oligomeric protein example is 1i8f. Let&#8217;s see how AlphaFold predicts our mutation for disruption of oligomerization.</p>
</div>
<div class="paragraph">
<p>Create a fasta file with seven fasta entries for each monomer we want to include in the prediction, 1i8f_I76P.fasta.
And don&#8217;t forget to change residue 76.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="o">&gt;</span>1I8F_I76P_A
MASDISKCFATLGATLQDSIGKQVLVKLRDSHEIRGILRSFDQHVNLLLEDAEEIIDGNVYKRGTMVVRGENVLFPSPVPG
<span class="o">&gt;</span>1I8F_I76P_B
MASDISKCFATLGATLQDSIGKQVLVKLRDSHEIRGILRSFDQHVNLLLEDAEEIIDGNVYKRGTMVVRGENVLFPSPVPG
<span class="o">&gt;</span>1I8F_I76P_C
MASDISKCFATLGATLQDSIGKQVLVKLRDSHEIRGILRSFDQHVNLLLEDAEEIIDGNVYKRGTMVVRGENVLFPSPVPG
<span class="o">&gt;</span>1I8F_I76P_D
MASDISKCFATLGATLQDSIGKQVLVKLRDSHEIRGILRSFDQHVNLLLEDAEEIIDGNVYKRGTMVVRGENVLFPSPVPG
<span class="o">&gt;</span>1I8F_I76P_E
MASDISKCFATLGATLQDSIGKQVLVKLRDSHEIRGILRSFDQHVNLLLEDAEEIIDGNVYKRGTMVVRGENVLFPSPVPG
<span class="o">&gt;</span>1I8F_I76P_F
MASDISKCFATLGATLQDSIGKQVLVKLRDSHEIRGILRSFDQHVNLLLEDAEEIIDGNVYKRGTMVVRGENVLFPSPVPG
<span class="o">&gt;</span>1I8F_I76P_G
MASDISKCFATLGATLQDSIGKQVLVKLRDSHEIRGILRSFDQHVNLLLEDAEEIIDGNVYKRGTMVVRGENVLFPSPVPG</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then adapt the multimer.sbatch example with the proper names of files and paths.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c">#!/bin/bash</span>

<span class="c">#SBATCH --auks=yes</span>
<span class="c">#SBATCH --partition=gpu</span>
<span class="c">#SBATCH --gpus=1</span>
<span class="c">#SBATCH --cpus-per-task=16</span>
<span class="c">#SBATCH --mem=100000</span>
<span class="c">#SBATCH --output=multimer.out </span><i class="conum" data-value="1"></i><b>(1)</b>

<span class="nv">dbdir</span><span class="o">=</span>/filer-dg/agruppen/DG/camara/AlphaFold_databases

<span class="nb">.</span> /etc/profile.d/modules.sh
module load alphafold
module load cuda-toolkit

<span class="nb">export </span><span class="nv">OPENMM_CUDA_COMPILER</span><span class="o">=</span>/opt/Bio/cuda-toolkit/11.6/bin/nvcc <i class="conum" data-value="8"></i><b>(8)</b>
<span class="nb">export </span><span class="nv">SINGULARITY_BIND</span><span class="o">=</span><span class="s2">"/filer,/filer-dg/agruppen/DG/camara/AlphaFold_databases/"</span>

singularity run <span class="nt">-B</span> /home/camara/AlphaFold/alphafold/modified_run_alphafold.py:/app/alphafold/run_alphafold.py /opt/Bio/alphafold/2.30.0/bin/alphafold <span class="se">\</span>
 <span class="nt">--max_template_date</span><span class="o">=</span>2023-03-16 <span class="se">\</span>
 <span class="nt">--uniref90_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/uniref90/uniref90.fasta <span class="se">\</span>
 <span class="nt">--mgnify_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/mgnify/mgy_clusters_2022_05.fa <span class="se">\</span>
 <span class="nt">--template_mmcif_dir</span><span class="o">=</span><span class="nv">$dbdir</span>/pdb_mmcif/mmcif_files <span class="se">\</span>
 <span class="nt">--obsolete_pdbs_path</span><span class="o">=</span><span class="nv">$dbdir</span>/pdb_mmcif/obsolete.dat <span class="se">\</span>
 <span class="nt">--use_gpu_relax</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
 <span class="nt">--bfd_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/bfd/bfd_metaclust_clu_complete_id30_c90_final_seq.sorted_opt <span class="se">\</span>
 <span class="nt">--uniref30_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/uniref30/UniRef30_2021_03 <span class="se">\</span>
 <span class="nt">--pdb_seqres_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/pdb_seqres/pdb_seqres.txt <span class="se">\</span>
 <span class="nt">--uniprot_database_path</span><span class="o">=</span><span class="nv">$dbdir</span>/uniprot/uniprot.fasta <span class="se">\</span>
 <span class="nt">--fasta_paths</span><span class="o">=</span>/home/camara/AlphaFold/workshop/multimer.fasta <span class="se">\ </span><i class="conum" data-value="2"></i><b>(2)</b>
 <span class="nt">--model_preset</span><span class="o">=</span>multimer <span class="se">\ </span><i class="conum" data-value="3"></i><b>(3)</b>
 <span class="nt">--data_dir</span><span class="o">=</span><span class="nv">$dbdir</span> <span class="se">\</span>
 <span class="nt">--output_dir</span><span class="o">=</span>/filer-dg/agruppen/DG/camara/AlphaFold_models/workshop/ <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Change the output file to 1i8f_I76P.out.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Change the input fasta file to /filer/projekte/protein_structure_workshop/amanda/1i8f_I76P.fasta.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This indicates it is a multimer.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Chenge the output folder to /filer/projekte/protein_structure_workshop/amanda/.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And send the job to slurm.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">sbatch 1i8f_I76P.sbatch</code></pre>
</div>
</div>
<div class="paragraph">
<p>Done!
Now try to run a prediction control with the original fasta sequence of 1i8f.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysing_the_output_of_alphafold2">Analysing the output of AlphaFold2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AlphaFold2 outputs a list of files with different information.
Here is a concise list discriminating them by type and content.
The * marks some variability in the name related to model number or input name.
They are all human-readable formats, except the .pkl.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="k">*</span>.out <i class="conum" data-value="1"></i><b>(1)</b>
relaxed_model_<span class="k">*</span>.pdb <i class="conum" data-value="2"></i><b>(2)</b>
unrelaxed_model_<span class="k">*</span>.pdb <i class="conum" data-value="3"></i><b>(3)</b>
ranked_<span class="k">*</span>.pdb <i class="conum" data-value="4"></i><b>(4)</b>
timings.json <i class="conum" data-value="5"></i><b>(5)</b>
ranking_debug.json <i class="conum" data-value="6"></i><b>(6)</b>
relax_metrix.json <i class="conum" data-value="7"></i><b>(7)</b>
features.pkl <i class="conum" data-value="8"></i><b>(8)</b>
result_model_<span class="k">*</span>.pkl <i class="conum" data-value="9"></i><b>(9)</b>
msas/ <i class="conum" data-value="10"></i><b>(10)</b>
    bfd_uniref_hits.a3m
    mgnify_hits.sto
    uniref90_hits.sto
    pdb_hits.hhr</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The *.out file is actually an immediate verbose of the command line.
It informs of possible errors encountered by AlphaFold and some details of what the program is doing.
For example it outputs a list of found templates, some timings and the length of some variables.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The relaxed_model_*.pdb is the most expected output. The best predicted model in a PDB format.
With the given input options, it is the only one that goes through the molecular dynamics minimization step.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The unrelaxed_model_*.pdb are the complete set of predicted models, not relaxed, given by AlphaFold2.
They are 5 for monomers and 25 for multimers. They vary in some input parameters that AlphaFold tries out as described in the
<a href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-03819-2/MediaObjects/41586_2021_3819_MOESM1_ESM.pdf">training procedure</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The ranked_*.pdb are exactly the same unrelaxed models but reordered by confidence.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The timings.json store the running times for each step of the AlphaFold pipeline.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The ranking_debug.json stores the confidence values, or the predicted Local Distance Difference Test (pLDDT) values, for each model and how they are ranked.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The relax_metrix.json lists structural violations per residue for the best ranked model.
It is usually a list of zeros, but predicted structures with clashes would appear differently here.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The features.pkl is a binary file with input parameters to write the .pdb files, including the multiple sequence alignment.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>The result_model_*.pkl are binnary files with values about the output models
<div class="ulist">
<ul>
<li>
<p>pLDDT, predicted Template Modelling score (pTM) and Predicted Aligned Error (PAE) values.</p>
</li>
</ul>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>msas is a folder containing the alignment hits from different tools.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The output .pdb files can be analysed as any other protein structure, in the same ways described previously in this tutorial.
So, indulge your curiosity and open the relaxed_model_*.pdb in PyMOL.
Use the align command to compare with solved structure.
What differences do you see?</p>
</div>
<div class="paragraph">
<p>We will now see how to retrieve confidence values, scores and errors.</p>
</div>
<div class="paragraph">
<p>First thing to check is how well does the found multiple sequence alignment cover the target, or input, sequence.
We will use a python script that reads the features.pkl, so just give the folder name as input.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"> python plot_coverage_msa.py /filer/projekte/protein_structure_workshop/amanda/4pcf_Q65L</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture20.png" alt="Picture20">
</div>
</div>
<div class="paragraph">
<p>In this image we can see how many sequences were found for each residue (black line),
to which region they align (coloured horizontal lines), and what is the identity to the given sequence (colour bar).</p>
</div>
<div class="paragraph">
<p>Do this for both proteins and compare how good are the alignments for the original sequence and for the mutated sequence.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look closer into each model generated.
Take a look at the ranking_debug.json. Just open it with a text editor.
It shows a list of values for each computed models that were used to rank them.
For monomers this is a list of 5 models, ranked by chain pLDDT values.
For multimers this is a list of 25 models, ranked by pTM + ipTM values.</p>
</div>
<div class="paragraph">
<p>See if you can identify the best models for our TIM barrel and heptamer example proteins.</p>
</div>
<div class="paragraph">
<p>predicted <a href="https://en.wikipedia.org/wiki/Template_modeling_score">Template Modelling</a> (pTM)
and interface predicted Template Modelling (ipTM) are single values for the measure of similarity between the predicted and the "real" structures.
They are stored in the result_model_*.pkl files and can be retrieved with a very simple python script.
Let&#8217;s check them for our best models of the TIM barrel and the heptamer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">python return_ptm_iptm.py 4pcf_Q65L/result_model_1_ptm_pred_0.pkl
python return_ptm_iptm.py 1i8f_I76P/result_model_3_multimer_v3_pred_1.pkl</code></pre>
</div>
</div>
<div class="paragraph">
<p>predicted link:https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3799472/ [Local Distance Difference Test]
compares proteins by evaluating local distances around all atoms.
AlphaFold reports it as values per residue, which are stored in the B factors column of the .pdb files.</p>
</div>
<div class="paragraph">
<p>This choice for storing the pLDDTs is not mere coincidence.
pLDDTs are often related to the flexibility of the protein, as local distances may vary due to its dynamics, among other reasons.
AlphaFold relates confidence of the model with the pLDDT in the following way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pLDDT&gt;90 Very high confidence</p>
</li>
<li>
<p>70&gt;pLDDT&gt;90 Confident</p>
</li>
<li>
<p>50&gt;pLDDT&gt;70 Low confidence</p>
</li>
<li>
<p>pLDDT&lt;50 Very low confidence</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Low pLDDT values indicate that the surroundings of a residue varies a lot among the found templates.
And AlphaFold authors described a relation between low pLDDTs and intrinsically disordered regions.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s check if AlphaFold could detect any change in flexibility related to our mutation in the TIM barrel.
First, let&#8217;s check if the loops of the predicted TIM barrel have a lower pLDDT than the rest and can be perceived as more flexible.
Similar to B factors, we can visualise pLDDT as the colour code for the protein in PyMOL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># File -&gt; Open -&gt; 4pc8_ranked_0.pdb
# Color of 4pc8_ranked_0 -&gt; spectrum -&gt; b-factors <i class="conum" data-value="1"></i><b>(1)</b>
&gt;
load 4pc8_ranked_0
spectrum b, rainbow, 4pc8_ranked_0
spectrum b, rainbow_rev, minimum=0, maximum=100 <i class="conum" data-value="2"></i><b>(2)</b>
set_color n0, [0.051, 0.341, 0.827] <i class="conum" data-value="3"></i><b>(3)</b>
set_color n1, [0.416, 0.796, 0.945]
set_color n2, [0.996, 0.851, 0.212]
set_color n3, [0.992, 0.490, 0.302]
color n0, b &lt; 100
color n1, b &lt; 90
color n2, b &lt; 70
color n3, b &lt; 50</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Colouring B factors as usual with the rainbow palette looks strange because of the range of pLDDT values.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>With command line we can choose a reverse rainbow palette and with better suited range.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>With command lines we can also apply the same colour palette for confidence as used by AlphaFold.</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture21.png" alt="Picture21">
</div>
</div>
<div class="paragraph">
<p>Note how the confidence is in general very high, except for the loops close to the active site and the N-terminal.</p>
</div>
<div class="paragraph">
<p>It&#8217;s easier to compare structures with 2D plots and we can retrieve the pLDDT using our python script for B factors.
Let&#8217;s first compare pLDDT with b factors from the experimentally solved structure.
So change the pdbfileslist.txt to consider them and then use the python script plot_bfactor.py as before (<a href="#flex">Flexibility analyses</a>).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture22.png" alt="Picture22" width="500">
</div>
</div>
<div class="paragraph">
<p>An obvious difference between the pLDDT and the B factors are the range of values and the inverse relation.
But some peaks of the B factors seem to agree with some valleys of the pLDDT.
Note that the last two valleys of the pLDDT seem to be shifted, as a result of missing residues from the original sequence that we didn&#8217;t considered.
Now let&#8217;s compare all the three predictions of 4pcf, 4pc8 and 4pcf_Q65L. Do you see a difference?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture23.png" alt="Picture23" width="500">
</div>
</div>
<div class="paragraph">
<p>The last parameter to analyse from AlphaFold is the Predicted Aligned Error (pae).
It gives the error distance of residue x if the predicted and 'true' structures were aligned at residue y.
So it is an asymmetric matrix, contrary to the contact map that we&#8217;ve calculated before (<a href="#oligo">Analyses of oligomers</a>).
It measures the relative position between two residues.
Moreover, it measures the relative position of domains.
In some cases, the structure of different domains is well predicted, but not their relative position,
and this appears in the PAE, as in this <a href="https://alphafold.ebi.ac.uk/entry/Q9Y223">example</a>.
For this analysis we will take the predictions made for the heptameric protein.</p>
</div>
<div class="paragraph">
<p>We have another python script to retrieve the PAE from the result_model_*.pkl files.
Like in the other python scripts, it takes a list of files as input, but it requires two chain columns, like in the pdbfileslist_cm.txt example,
it also needs a pdb file of the predicted structure (any model would do) to retrieve the information on residue and chain number.
So create a text file with this information, pklfileslist_pae.txt</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">1i8f_I76P/1i8f_I76P_ranked_0.pdb
1i8f_I76P/result_model_3_multimer_v3_pred_1.pkl A A
1i8f_I76P/result_model_3_multimer_v3_pred_1.pkl A B</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then run the plot_pae.py python script.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">python plot_pae.py pklfileslist_pae.txt</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture24.png" alt="Picture24">
</div>
</div>
<div class="paragraph">
<p>Can you recognise different regions, or domains, of the protein?
Compared with the contact map we generated before, what information can you take from the interchain PAE?</p>
</div>
<div class="paragraph">
<p>Now try to generate PAE matrices for the predicted model with the original sequence of 1i8f.
What differences do you spot in a comparison with the predicted mutated structure?
Like in the analysis with the pLDDT, the differences, if any, are very mild.
And being a heat map, instead of a 2D plot, makes it even harder to compare.
So we will take the difference between the PAEs of 1i8f and 1i8f_I76P.
For this, we will the last python script of this tutorial, plot_pae_diff.py
Again, it takes a list of files as input, but only two entry files are allowed, for the calculation of PAE of the first minus the PAE of the second.
So let&#8217;s write a new input files list, pklfileslist_pae_diff.txt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1i8f_I76P/1i8f_I76P_ranked_0.pdb
1i8f_I76P/result_model_3_multimer_v3_pred_1.pkl A A
1i8f/result_model_3_multimer_v3_pred_2.pkl A A</pre>
</div>
</div>
<div class="paragraph">
<p>And run the python script plot_pae_diff.py.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">python3 plot_pae_diff.py pklfileslist_pae_diff.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>And do the same for interchain contacts.</p>
</div>
<div class="paragraph">
<p>What differences due to the mutation do you observe now? Are they meaningful?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="Pictures/Picture25.png" alt="Picture25">
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-09-15 11:41:56 +0200
</div>
</div>
</body>
</html>